<!doctype html>
<meta charset="utf-8">
<title>ã‚¯ãƒ¼ãƒãƒ³ | {{ post.store_name }}</title>
<style>
  body{font-family: system-ui, -apple-system,"Noto Sans JP",sans-serif; padding:20px}
  .code{font-size:2rem; letter-spacing:.1em; font-weight:700}
  .box{border:1px solid #ddd; padding:16px; border-radius:12px; max-width:520px}
  .muted{color:#666; font-size:.9rem}
  a.btn{display:inline-block; padding:8px 12px; border-radius:10px; border:1px solid #ccc; text-decoration:none; background:#f5f5f5; color:#333}
  a.btn:hover{background:#e5e5e5}
</style>
<h1>{{ post.store_name }} ã®ã‚¯ãƒ¼ãƒãƒ³</h1>
<div class="box">
  <div>ä¼šè¨ˆæ™‚ã«ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã›ã¦ãã ã•ã„ï¼š</div>
  <div class="code">{{ code }}</div>
  <ul class="muted">
    <li>ä¸€äººä¸€å›ã¾ã§ï¼ä»–å‰²å¼•ã¨ä½µç”¨ä¸å¯ï¼ˆåº—èˆ—è£é‡ï¼‰</li>
    <li>æœ‰åŠ¹æœŸé™ï¼šæç¤ºæ—¥å½“æ—¥</li>
  </ul>
</div>
<p><button class="btn ad-map-btn" data-url="{{ url_for('tracking_ad.go', post_id=post.id) }}">ğŸ—º åº—ã®åœ°å›³ã‚’é–‹ã</button></p>
<script>
// ã‚¯ãƒ¼ãƒãƒ³ãƒšãƒ¼ã‚¸ç”¨ã®å€‹åˆ¥JavaScriptï¼ˆãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–ï¼‰
document.addEventListener('DOMContentLoaded', function() {
    function handleMapButton(e) {
        if (e.target.classList.contains('ad-map-btn')) {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            
            const url = e.target.getAttribute('data-url');
            if (url) {
                // ãƒ¢ãƒã‚¤ãƒ«ç”¨ã®å¼·åˆ¶çš„ãªãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
                if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                    // ãƒ¢ãƒã‚¤ãƒ«ã®å ´åˆã€ç›´æ¥location.hrefã§é·ç§»
                    window.location.href = url;
                } else {
                    // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã®å ´åˆã€æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
                    window.open(url, '_blank', 'noopener,noreferrer');
                }
            }
        }
    }

    // ã‚¿ãƒƒãƒã¨ã‚¯ãƒªãƒƒã‚¯ä¸¡æ–¹ã«å¯¾å¿œ
    document.addEventListener('click', handleMapButton);
    document.addEventListener('touchend', handleMapButton);
});
</script>